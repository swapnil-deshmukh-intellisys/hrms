<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<div class="company-bar">
  <span class="company-name">Intellisys IT Solutions Pvt. Ltd - Admin Dashboard</span>
  <div class="right-content">
    
    <div class="employee-details">
      <span class="employee-name">{{ username || 'Guest' }}</span>
      <div class="employee-info">
        <span><strong>Employee </strong><strong>Code:</strong> {{ employeeCode || 'N/A' }}</span>
      </div>
    </div>

    <img
      [src]="employeeImage || 'assets/employee (1).png'"
      (error)="employeeImage = 'assets/employee (1).png'"
      alt="{{ username || 'Employee' }}'s photo"
      class="employee-image"
    />
    <button class="logout-btn" (click)="logout()">
      <i class="fas fa-sign-out-alt"></i> Logout
    </button>
    <div class="notification-container">
      <mat-icon 
        class="notification-icon"
        (click)="toggleNotifications()">notifications</mat-icon>
      <span *ngIf="unreadNotificationsCount > 0" class="notification-badge" [class.badge-large]="unreadNotificationsCount > 9">
        {{ unreadNotificationsCount > 99 ? '99+' : unreadNotificationsCount }}
      </span>
      <!-- Debug: Remove this after testing -->
      <!-- <span style="color: white; font-size: 10px; margin-left: 5px;">Count: {{ unreadNotificationsCount }}</span> -->
      
      <!-- Notification popup -->
      <div *ngIf="showNotifications" class="notification-popup">
        <div class="notification-header">
          <h3>Notifications</h3>
          <button class="close-btn" (click)="showNotifications = false"><mat-icon>close</mat-icon></button>
        </div>
        <div class="notification-list">
          <div *ngFor="let notification of notifications" 
               class="notification-item" 
               [class.unread]="!notification.isRead"
               [class.clickable]="notification.actionRoute"
               (click)="handleNotificationClick(notification)">
            <div class="notification-content">
              <strong>{{ notification.title }}</strong>
              <p>{{ notification.message }}</p>
              <small>{{ notification.createdAt | date:'shortTime' }} â€¢ {{ notification.createdAt | date:'mediumDate' }}</small>
              <span *ngIf="notification.actionRoute" class="action-hint">
                <mat-icon>arrow_forward</mat-icon> Click to view
              </span>
            </div>
          </div>
          <div *ngIf="notifications.length === 0" class="empty-notifications">
            No new notifications
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
